This is the github repository for the paper: *Structural constraints acting on the SARS-CoV-2 S protein reveals limited space for viral adaptation*

## Paper Abstract
The SARS-CoV-2 pandemic resulted in an unprecedented scientific response. The enormous scale of global genome sequencing, protein structural determination and targeted studies of protein and variant dynamics has resulted in a unique dataset which provides a valuable resource for understanding of viral evolutionary dynamics. Previous analysis of SARS-CoV-2 evolution has revealed apparently saltatory dynamics, with viral variants arising following large evolutionary jumps without genetic intermediates represented in the sequence database. We utilise rich SARS-CoV-2 datasets to interrogate the role of protein structural constraint in SARS-CoV-2 evolution and whether these evolutionary jumps may result from the viral spike protein accessing new regions of viable sequence space. We apply multiple computational predictors of structural constraint across different structural backgrounds and assess how constraint has changed during SARS-CoV-2 variant evolution. These predictions are validated using substitution data from the SARS-CoV-2 global sequence database. We find that all predictive methods suggest that the structural constraint experienced by specific sites has undergone very limited change, despite significant phenotypic evolution of the SARS-CoV-2 S protein. Signature mutations for variants of concern are not found to be under structural constraint by any computational predictor regardless of which viral variant structure is used to calculate predictions. We also develop a machine learning model to assess substitution viability, combining predictors of evolutionary constraint with information about local structural context. This confirms our conclusions, with model performance largely unaffected by the use of different viral variant structures. We also find no reduction in the shared proportion of accessible substitutions over evolutionary time, as would be expected if the S protein had entered and explored novel sequence space during variant evolution. These results suggest that despite its rapid rate of mutation, the SARS-CoV-2 S protein is subject to strict structural constraints and shows that viral genomes exhibit limited plasticity following infection of a new host.

All package and version information is available in the requirements.txt file
